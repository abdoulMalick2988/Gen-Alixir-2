// GEN ALIXIR - Database Schema (Phase 1)
// Base de donn√©es pour l'incubateur num√©rique africain

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// √ânum√©ration des r√¥les disponibles
enum Role {
  MEMBER           // Membre standard
  PROJECT_LEAD     // Chef de Projet
  FOUNDER          // Membre Fondateur
  MODERATOR        // Mod√©rateur
}

// Table principale des utilisateurs
// G√®re l'authentification via email + PIN (PAS de mot de passe)
model User {
  id         String   @id @default(uuid())
  email      String   @unique
  pin_hash   String   // PIN hash√© avec bcrypt (4-6 chiffres)
  role       Role     @default(MEMBER)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  
  // Relation one-to-one avec le profil
  profile    Profile?
  
  @@map("users")
}

// Table des profils utilisateurs
// Contient toutes les informations personnelles et de progression
model Profile {
  id             String   @id @default(uuid())
  user_id        String   @unique
  full_name      String
  country        String
  
  // Syst√®me PCO (Points de Contribution)
  pco            Int      @default(0)
  
  // AURA - Traits de caract√®re (max 3)
  // Exemples: ["Dynamique", "Cr√©atif", "Collaboratif"]
  aura           String[] @default([])
  
  // Badge v√©rifi√© pour AURA
  // True si v√©rifi√© par fondateur ou membre ‚â• 90 PCO
  aura_verified  Boolean  @default(false)
  
  // SKILLS - Comp√©tences techniques (max 3)
  // Exemples: ["Design", "Vid√©o/Image", "Dev", "Marketing"]
  skills         String[] @default([])
  
  created_at     DateTime @default(now())
  updated_at     DateTime @updatedAt
  
  // Relation avec l'utilisateur
  user           User     @relation(fields: [user_id], references: [id], onDelete: Cascade)
  
  @@map("profiles")
}

// üîÆ PR√âPARATION PHASE 2
// Les tables suivantes seront activ√©es dans la Phase 2
// pour g√©rer les projets et la logique PCO avanc√©e

// model Project {
//   id              String   @id @default(uuid())
//   name            String
//   description     String
//   status          ProjectStatus
//   project_lead_id String
//   created_at      DateTime @default(now())
//   updated_at      DateTime @updatedAt
//   
//   members         ProjectMember[]
//   tasks           Task[]
//   
//   @@map("projects")
// }

// model ProjectMember {
//   id         String   @id @default(uuid())
//   project_id String
//   user_id    String
//   role       String
//   joined_at  DateTime @default(now())
//   
//   project    Project  @relation(fields: [project_id], references: [id])
//   
//   @@unique([project_id, user_id])
//   @@map("project_members")
// }

// model Task {
//   id          String   @id @default(uuid())
//   project_id  String
//   title       String
//   description String?
//   pco_value   Int
//   assigned_to String?
//   status      TaskStatus
//   created_at  DateTime @default(now())
//   completed_at DateTime?
//   
//   project     Project  @relation(fields: [project_id], references: [id])
//   
//   @@map("tasks")
// }

// model PcoHistory {
//   id         String   @id @default(uuid())
//   user_id    String
//   amount     Int
//   reason     String
//   created_at DateTime @default(now())
//   
//   @@map("pco_history")
// }
